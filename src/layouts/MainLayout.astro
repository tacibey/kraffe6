---
// src/layouts/MainLayout.astro

// Gerekli bileşenleri ve sabitleri import et
import Meta from "@components/Meta.astro";
import Navbar from "@components/sections/navbar&footer/Navbar.astro";
import FooterSection from "@components/sections/navbar&footer/FooterSection.astro";
import AnnouncementBanner from "@components/ui/banners/AnnouncementBanner.astro";
import { SITE } from "@data/constants";
import "@styles/global.css";
import { getRelativeLocaleUrl } from "astro:i18n";

// Prop tanımları
const { title = SITE.title, meta, structuredData, lang = "en" } = Astro.props;

// Prop arayüzü
interface Props {
  title?: string;
  meta?: string;
  structuredData?: object;
  lang?: string;
}

// Dinamik banner props'ları için dil ve URL belirle
const currentLang = Astro.currentLocale || 'en';
const contactUrl = getRelativeLocaleUrl(currentLang, 'contact');
const buttonText = currentLang === 'fr' ? 'Obtenir une offre' : 'Get Offer';

// === GOOGLE ANALYTICS MEASUREMENT ID ===
const gaMeasurementId = "G-04W4B3DX9F";
// === /GOOGLE ANALYTICS MEASUREMENT ID ===
---

<html lang={lang} class="dark scrollbar-hide lenis lenis-smooth scroll-pt-16">
  <head>
    {/* Meta etiketleri ve diğer başlık bilgileri */}
    <Meta meta={meta} structuredData={structuredData} />
    <title>{title}</title>
    
    {/* Lenis smooth scroll scripti */}
    <script>
      import "@scripts/lenisSmoothScroll.js";
    </script>

    {/* === GOOGLE ANALYTICS KODU BAŞLANGICI === */}
    {gaMeasurementId && (
      <Fragment>
        <script is:inline async src={`https://www.googletagmanager.com/gtag/js?id=${gaMeasurementId}`}></script>
        <script is:inline define:vars={{ gaMeasurementId }}>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', gaMeasurementId);
        </script>
      </Fragment>
    )}
    {/* === GOOGLE ANALYTICS KODU SONU === */}

  </head>
  <body
    class="bg-neutral-200 selection:bg-yellow-400 selection:text-neutral-700 dark:bg-neutral-800"
  >
    <div class="mx-auto max-w-(--breakpoint-2xl) px-4 sm:px-6 lg:px-8">
      <Navbar />
      <main>
        <slot /> {/* Sayfa içeriği buraya gelecek */}
      </main>
    </div>

    <AnnouncementBanner
      btnId="floating-offer-button"
      btnTitle={buttonText}
      url={contactUrl}
    />

    <FooterSection />

    <script>
      import "preline/preline.js";
    </script>
    <style>
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    </style>
  </body>
</html>
